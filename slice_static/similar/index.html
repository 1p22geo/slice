<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title></title>
    <script src="../js/config.js"></script>
    <script src="https://cdn.tailwindcss.com/"></script>
    <script defer src="../js/similar.js"></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
  </head>
  <body>
    <div
      class="flex flex-col items-center w-full mt-24"
      x-data="{
        samples:[
      ],
        resultCount: 0,
        loading: true
      }"
      x-init="
      request().then(json=>{
        samples = json.results;
        resultCount = json.resultCount;
        loading = false;
      })
      "
    >
      <h2 class="text-xl text-gray-600" x-show="loading" x-transition>
        Loading your samples
      </h2>
      <div x-show="!loading" x-transition class="w-full">
        <h2 class="self-left text-gray-600 ml-8">
          <span x-text="resultCount"></span> samples loaded
        </h2>
        <div class="flex flex-row gap-4 p-12">
          <div class="flex flex-col items-left">
            <template x-for="sample in samples">
              <h2 x-text="sample.display.name" class="p-2 h-10"></h2>
            </template>
          </div>
          <div class="flex flex-col items-left">
            <template x-for="sample in samples">
              <audio
                controls
                x-on:mouseenter="$el.play()"
                x-on:mouseleave="$el.pause()"
                class ="h-10"
              >
                <!--                         yeeeeeeee, production-ready code                  -->
                <source
                  x-bind:src="AUDIO_URL+sample.path.replace('#', '%23')"
                  type="audio/ogg"
                />
              </audio>
            </template>
          </div>
          <div class="flex flex-col items-left">
            <template x-for="sample in samples">
              <a
                x-bind:href="AUDIO_URL+sample.path.replace('#', '%23')"
                class="font-ultralight text-gray-600 p-2 h-10"
                download
                >download</a
              >
            </template>
          </div>
          <div class="flex flex-col items-left">
            <template x-for="sample in samples">
              <a
                x-bind:href="'/similar?id=' + sample._id"
                class="font-ultralight text-gray-600 p-2 h-10"
                >find similar</a
              >
            </template>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
